"Bob", "Cecil", "Cecil", "David", "David", "Esmeralda", "Bob", "Alice",
"Cecil", "David"
),
to = c(
"Alice", "Bob", "Alice", "Alice", "Bob", "Alice", "Bob", "Alice", "Cecil",
"David"
),
friendship = c(4, 5, 5, 2, 1, 1, 2, 1, 3, 4),
type = c(1, 1, 1, 1, 1, 2, 2, 2, 2, 2)
)
Network(relations, actors)
Network(relations, actors,
link_weight_by = "friendship", node_size_by = "age",
node_fill_by = "gender", link_color_by = "to",
layout = "circle", link_curvature = 0.2
)
Network(relations, actors,
layout = "tree", directed = FALSE, cluster = "fast_greedy",
add_mark = TRUE
)
# Create sample data
data <- data.frame(
x = c("A", "B", "C", "D", "E", "F", "G", "H"),
y = c(10, 8, 16, 4, 6, 12, 14, 2),
group = c("G1", "G1", "G2", "G2", "G3", "G3", "G4", "G4"),
facet = c("F1", "F2", "F3", "F4", "F1", "F2", "F3", "F4")
)
# Basic pie chart
PieChart(data, x = "x", y = "y")
# Counter-clockwise
PieChart(data, x = "x", y = "y", clockwise = FALSE)
# With labels
PieChart(data, x = "x", y = "y", label = "group")
# With faceting
PieChart(data, x = "x", y = "y", facet_by = "facet")
# Split by group
PieChart(data, x = "x", y = "y", split_by = "group")
# Custom palettes per split
PieChart(data,
x = "x", y = "y", split_by = "group",
palette = list(G1 = "Reds", G2 = "Blues", G3 = "Greens", G4 = "Purples")
)
# Use counts (y from count)
PieChart(data, x = "group")
# With count labels
PieChart(data, x = "group", label = ".y")
set.seed(8525)
data <- data.frame(norm = rnorm(100))
QQPlot(data, val = "norm", band = TRUE)
QQPlot(data, val = "norm", band = list(
list(bandType = "ks", mapping = ggplot2::aes(fill = "KS"), alpha = 0.3),
list(bandType = "ts", mapping = ggplot2::aes(fill = "TS")),
list(bandType = "pointwise", mapping = ggplot2::aes(fill = "Normal")),
list(bandType = "boot", mapping = ggplot2::aes(fill = "Bootstrap"))
), band_alpha = 0.6)
data(airquality, package = "datasets")
di <- "exp" # exponential distribution
dp <- list(rate = 2) # exponential rate parameter
QQPlot(airquality,
val = "Ozone",
band = list(distribution = di, dparams = dp),
line = list(distribution = di, dparams = dp),
point = list(distribution = di, dparams = dp)
)
de <- TRUE # enabling the detrend option
QQPlot(airquality,
val = "Ozone",
band = list(distribution = di, dparams = dp, detrend = de),
line = list(distribution = di, dparams = dp, detrend = de),
point = list(distribution = di, dparams = dp, detrend = de)
)
QQPlot(data, val = "norm", type = "pp", band = TRUE)
dp <- list(mean = 2, sd = 2) # shifted and rescaled Normal parameters
QQPlot(data,
val = "norm", type = "pp",
band = list(dparams = dp),
point = list(dparams = dp)
)
QQPlot(data,
val = "norm", type = "pp", band = TRUE,
line = list(ab = c(.2, .5))
)
di <- "exp"
dp <- list(rate = .022) # value is based on some empirical tests
de <- TRUE
QQPlot(airquality,
val = "Ozone", type = "pp",
band = list(distribution = di, detrend = de, dparams = dp),
line = list(detrend = de),
point = list(distribution = di, detrend = de, dparams = dp),
ylim = c(-.5, .5)
)
# Use counts
data <- data.frame(
x = c(rep("A", 2), rep("B", 3), rep("C", 3), rep("D", 4), rep("E", 5)),
group = sample(paste0("G", 1:4), 17, replace = TRUE)
)
RadarPlot(data, x = "x")
RadarPlot(data, x = "x", bg_color = "lightpink")
RadarPlot(data, x = "x", scale_y = "none")
RadarPlot(data, x = "x", group_by = "group")
SpiderPlot(data, x = "x")
SpiderPlot(data, x = "x", group_by = "group")
# Use y values
data <- data.frame(
x = rep(LETTERS[1:5], 2),
y = c(1, 3, 6, 4, 2, 5, 7, 8, 9, 10),
group = rep(c("G1", "G2"), each = 5)
)
RadarPlot(data, x = "x", y = "y", scale_y = "none", group_by = "group")
RadarPlot(data, x = "x", y = "y", facet_by = "group")
RadarPlot(data, x = "x", y = "y", split_by = "group")
RadarPlot(data,
x = "x", y = "y", split_by = "group",
palette = c(G1 = "Set1", G2 = "Paired")
)
set.seed(8525)
spider <- list(
Girdled = c(46, 22, 17, 15, 15, 9, 8, 6, 6, 4, rep(2, 4), rep(1, 12)),
Logged = c(
88, 22, 16, 15, 13, 10, 8, 8, 7, 7, 7, 5, 4, 4, 4, 3, 3, 3, 3,
2, 2, 2, 2, rep(1, 14)
)
)
RarefactionPlot(spider)
RarefactionPlot(spider, q = c(0, 1, 2), facet_by = "q")
RarefactionPlot(spider, q = c(0, 1, 2), split_by = "q")
RarefactionPlot(spider,
q = c(0, 1, 2), split_by = "q",
palette = c("0" = "Paired", "1" = "Set1", "2" = "Dark2")
)
RarefactionPlot(spider,
q = c(0, 1, 2), group_by = "q",
facet_by = "group", palette = "Set1", type = 3
)
# Basic ring plot with single ring
RingPlot(datasets::iris, group_by = "Species")
# Multiple rings
data <- data.frame(
x = c("A", "B", "C", "A", "B", "C"),
y = c(1, 2, 3, 4, 5, 6),
group = c("a", "a", "a", "b", "b", "b")
)
RingPlot(data, x = "x", y = "y", group_by = "group")
# With faceting
RingPlot(datasets::mtcars, x = "cyl", group_by = "carb", facet_by = "vs")
# With splitting and custom palettes
RingPlot(datasets::mtcars,
x = "cyl", group_by = "carb", split_by = "vs",
palette = c("0" = "Set1", "1" = "Paired")
)
set.seed(8525)
D.ex <- rbinom(200, size = 1, prob = .5)
M1 <- rnorm(200, mean = D.ex, sd = .65)
M2 <- rnorm(200, mean = D.ex, sd = 1.5)
gender <- c("Male", "Female")[rbinom(200, 1, .49) + 1]
data <- data.frame(
D = D.ex, D.str = c("Healthy", "Ill")[D.ex + 1],
gender = gender, M1 = M1, M2 = M2
)
ROCCurve(data, truth_by = "D", score_by = "M1")
# will warn about the positive label
ROCCurve(data, truth_by = "D.str", score_by = "M1")
ROCCurve(data, truth_by = "D", score_by = "M1", increasing = FALSE)
# Multiple ROC curves
ROCCurve(data, truth_by = "D", score_by = c("M1", "M2"), group_name = "Method")
ROCCurve(data, truth_by = "D", score_by = "M1", group_by = "gender", show_auc = "plot")
# Reverse the x-axis and display the axes as percentages
ROCCurve(data, truth_by = "D", score_by = "M1", x_axis_reverse = TRUE, percent = TRUE)
# Pass additional arguments to geom_roc and make the curve black
ROCCurve(data, truth_by = "D", score_by = "M1", n_cuts = 10, palcolor = "black")
# Add confidence intervals
ROCCurve(data, truth_by = "D", score_by = "M1", ci = list(sig.level = .01))
# Facet by a column
ROCCurve(data, truth_by = "D", score_by = "M1", facet_by = "gender")
# Show cutoffs
ROCCurve(data, truth_by = "D", score_by = "M1", cutoffs_at = c(0, "ROC01", "SpEqualSe"))
# Split by a column
p <- ROCCurve(data, truth_by = "D", score_by = "M1", split_by = "gender")
p
# Retrieve the AUC values
attr(p, "auc")
# Retrieve the cutoffs
attr(p, "cutoffs")
# Reproduce the examples in ggalluvial
set.seed(8525)
data(UCBAdmissions, package = "datasets")
UCBAdmissions <- as.data.frame(UCBAdmissions)
SankeyPlot(as.data.frame(UCBAdmissions),
x = c("Gender", "Dept"),
y = "Freq", nodes_width = 1 / 12, links_fill_by = "Admit", nodes_label = TRUE,
nodes_palette = "simspec", links_palette = "Set1", links_alpha = 0.5,
nodes_palcolor = "black", links_color = "transparent"
)
data(HairEyeColor, package = "datasets")
SankeyPlot(as.data.frame(HairEyeColor),
x = c("Hair", "Eye", "Sex"),
y = "Freq", links_fill_by = "Eye", nodes_width = 1 / 8, nodes_alpha = 0.4,
flip = TRUE, reverse = FALSE, knot.pos = 0, links_color = "transparent",
ylab = "Freq", links_alpha = 0.5, links_name = "Eye (links)", links_palcolor = c(
Brown = "#70493D", Hazel = "#E2AC76", Green = "#3F752B", Blue = "#81B0E4"
)
)
data(Refugees, package = "alluvial")
country_regions <- c(
Afghanistan = "Middle East",
Burundi = "Central Africa",
`Congo DRC` = "Central Africa",
Iraq = "Middle East",
Myanmar = "Southeast Asia",
Palestine = "Middle East",
Somalia = "Horn of Africa",
Sudan = "Central Africa",
Syria = "Middle East",
Vietnam = "Southeast Asia"
)
Refugees$region <- country_regions[Refugees$country]
SankeyPlot(Refugees,
x = "year", y = "refugees", alluvium = "country",
links_fill_by = "country", links_color = ".fill", links_alpha = 0.75,
links_palette = "Set3", facet_by = "region", x_text_angle = -45, nodes_legend = "none",
theme_args = list(strip.background = ggplot2::element_rect(fill = "grey80")),
decreasing = FALSE, nodes_width = 0, nodes_color = "transparent", ylab = "refugees",
title = "Refugee volume by country and region of origin"
)
data(majors, package = "ggalluvial")
majors$curriculum <- as.factor(majors$curriculum)
SankeyPlot(majors,
x = "semester", stratum = "curriculum", alluvium = "student",
links_fill_by = "curriculum", flow = TRUE, stat = "alluvium", nodes_palette = "Set2",
links_palette = "Set2"
)
data(vaccinations, package = "ggalluvial")
vaccinations <- transform(vaccinations,
response = factor(response, rev(levels(response)))
)
SankeyPlot(vaccinations,
x = "survey", stratum = "response", alluvium = "subject",
y = "freq", links_fill_by = "response", nodes_label = TRUE, nodes_alpha = 0.5,
nodes_palette = "seurat", links_palette = "seurat", links_alpha = 0.5,
legend.position = "none", flow = TRUE, expand = c(0, 0, 0, .15), stat = "alluvium",
title = "vaccination survey responses at three points in time"
)
data(Titanic, package = "datasets")
SankeyPlot(as.data.frame(Titanic),
x = c("Class", "Sex"), y = "Freq",
links_fill_by = "Survived", flow = TRUE, facet_by = "Age", facet_scales = "free_y",
nodes_label = TRUE, expand = c(0.05, 0), xlab = "", links_palette = "Set1",
nodes_palcolor = "white", nodes_label_miny = 10
)
# Simulated examples
df <- data.frame(
Clone = paste0("clone", 1:10),
Timepoint1 = sample(c(rep(0, 30), 1:100), 10),
Timepoint2 = sample(c(rep(0, 30), 1:100), 10)
)
SankeyPlot(df,
x = c("Timepoint1", "Timepoint2"), alluvium = "Clone",
links_color = ".fill"
)
df <- data.frame(
Clone = rep(paste0("clone", 1:6), each = 2),
Timepoint1 = sample(c(rep(0, 30), 1:100), 6),
Timepoint2 = sample(c(rep(0, 30), 1:100), 6),
Group = rep(c("A", "B"), 6)
)
SankeyPlot(df,
x = c(".", "Timepoint1", "Timepoint2"),
stratum = "Group", links_fill_by = "Clone", links_color = ".fill"
)
# Create sample data
set.seed(8525)
data <- data.frame(
x = rnorm(100),
y = rnorm(100),
size_val = abs(rnorm(100)),
category = sample(c("A", "B", "C"), 100, replace = TRUE),
group = sample(c("Group1", "Group2"), 100, replace = TRUE)
)
# Basic scatter plot
ScatterPlot(data, x = "x", y = "y")
# Highlight specific points
ScatterPlot(data, x = "x", y = "y", highlight = "x > 1 & y > 0")
# Size by numeric column
ScatterPlot(data, x = "x", y = "y", size_by = "size_val")
# Color by numeric column with continuous gradient
ScatterPlot(data, x = "x", y = "y", color_by = "size_val", palette = "RdYlBu")
# Color by categorical column
ScatterPlot(data, x = "x", y = "y", color_by = "category")
# Combine size and color mapping with custom border
ScatterPlot(data,
x = "x", y = "y", size_by = "size_val", color_by = "category",
border_color = "black"
)
# Border color matches fill color (for cohesive look)
ScatterPlot(data,
x = "x", y = "y", color_by = "category",
border_color = TRUE
)
# Use shape without fill (solid points)
ScatterPlot(data,
x = "x", y = "y", color_by = "category",
shape = 16, palette = "Set1"
)
# Split by group to create separate panels
ScatterPlot(data,
x = "x", y = "y", color_by = "category",
split_by = "group", combine = TRUE
)
# Facet by group (alternative to split_by)
ScatterPlot(data, x = "x", y = "y", color_by = "category", facet_by = "group")
# Log transformation of axes
data_pos <- data.frame(
x = 10^rnorm(100, 2, 1),
y = 10^rnorm(100, 3, 0.5)
)
ScatterPlot(data_pos, x = "x", y = "y", xtrans = "log10", ytrans = "log10")
# Create a simple raster
library(terra)
r <- rast(ncols = 100, nrows = 100, xmin = 0, xmax = 100, ymin = 0, ymax = 100)
values(r) <- runif(ncell(r))
# Plot raster image
SpatImagePlot(r, palette = "viridis")
# Plot with custom extent
SpatImagePlot(r, ext = c(20, 80, 20, 80), palette = "turbo")
# Create a mask raster
library(terra)
r <- rast(ncols = 50, nrows = 50, xmin = 0, xmax = 50, ymin = 0, ymax = 50)
values(r) <- sample(0:3, ncell(r), replace = TRUE)
# Plot masks with borders
SpatMasksPlot(r, add_border = TRUE, palette = "Set2")
# Create polygon data
library(terra)
v <- vect("POLYGON ((0 0, 10 0, 10 10, 0 10, 0 0))")
# Plot shapes
SpatShapesPlot(v, fill_by = "grey80", border_color = "black")
# Plot with data.frame
poly_df <- data.frame(
x = c(0, 10, 10, 0),
y = c(0, 0, 10, 10),
group = rep(1, 4)
)
SpatShapesPlot(poly_df, x = "x", y = "y", group = "group")
# Create spatial point data
spatial_data <- data.frame(
x = runif(1000, 0, 100),
y = runif(1000, 0, 100),
cluster = sample(c("A", "B", "C"), 1000, replace = TRUE),
value = rnorm(1000)
)
# Basic point plot
SpatPointsPlot(spatial_data, x = "x", y = "y", color_by = "cluster")
# Continuous color scale
SpatPointsPlot(spatial_data, x = "x", y = "y", color_by = "value", palette = "viridis")
# Hex binning for large datasets
SpatPointsPlot(spatial_data, x = "x", y = "y", color_by = "value", hex = TRUE)
# Add labels
SpatPointsPlot(spatial_data,
x = "x", y = "y", color_by = "cluster",
label = TRUE, label_repel = TRUE
)
# Create sample data
data <- data.frame(
x = rep(c("A", "B", "C", "D"), 2),
y = c(1, 3, 6, 4, 2, 5, 7, 8),
group = rep(c("F1", "F2"), each = 4)
)
# Basic trend plot
TrendPlot(data, x = "x", y = "y", group_by = "group")
# With scaled y-axis
TrendPlot(data, x = "x", y = "y", group_by = "group", scale_y = TRUE)
# Split by group
TrendPlot(data, x = "x", y = "y", split_by = "group")
# Custom palettes per split
TrendPlot(data,
x = "x", y = "y", split_by = "group",
palette = list(F1 = "Set1", F2 = "Paired")
)
# Example 1: Basic upset plot with list input
data <- list(
A = 1:5,
B = 2:6,
C = 3:7,
D = 4:8
)
UpsetPlot(data)
# Example 2: Without labels
UpsetPlot(data, label = FALSE)
# Example 3: Custom palette and show all overlaps
UpsetPlot(data, palette = "Reds", specific = FALSE)
# Example 4: Limit number of sets and intersections
UpsetPlot(data, n_sets = 3, n_intersections = 10)
# Example 5: Wide format data
wide_data <- data.frame(
A = c(TRUE, TRUE, FALSE, TRUE),
B = c(TRUE, FALSE, TRUE, TRUE),
C = c(FALSE, TRUE, TRUE, TRUE)
)
UpsetPlot(wide_data, in_form = "wide")
# Load example data
data(dim_example)
# Basic raw velocity plot
VelocityPlot(
embedding = dim_example[, 1:2],
v_embedding = dim_example[, 3:4]
)
# Velocity plot with grouping
VelocityPlot(
embedding = dim_example[, 1:2],
v_embedding = dim_example[, 3:4],
group_by = dim_example$clusters,
group_palette = "Set2"
)
# Grid-based velocity plot (smoothed arrows)
VelocityPlot(
embedding = dim_example[, 1:2],
v_embedding = dim_example[, 3:4],
plot_type = "grid",
density = 2
)
# Streamline velocity plot
VelocityPlot(
embedding = dim_example[, 1:2],
v_embedding = dim_example[, 3:4],
plot_type = "stream",
streamline_n = 20
)
set.seed(8525)
data <- list(
A = sort(sample(letters, 8)),
B = sort(sample(letters, 8)),
C = sort(sample(letters, 8)),
D = sort(sample(letters, 8))
)
VennDiagram(data)
VennDiagram(data, fill_mode = "set")
VennDiagram(data, label = "both")
VennDiagram(data, palette = "material-indigo", alpha = 0.6)
set.seed(8525)
# Obtained by Seurat::FindMarkers for the first cluster of pbmc_small
data <- data.frame(
avg_log2FC = c(
-3.69, -4.10, -2.68, -3.51, -3.09, -2.52, -3.53, -3.35, -2.82, -2.71,
3.67, 4.79, 10.14, 5.36, 4.56, 4.62, 3.31, 4.72, 3.01, 3.86
),
p_val_adj = c(
3.82e-09, 1.52e-07, 1.79e-07, 4.68e-07, 4.83e-07, 6.26e-07, 2.61e-06,
1.33e-05, 1.79e-05, 3.71e-05, 8.93e-04, 9.61e-04, 1.47e-03, 4.35e-03,
4.85e-03, 5.12e-03, 1.90e-02, 2.13e-02, 3.80e-02, 6.72e-02
),
gene = c(
"HLA-DPB1", "LYZ", "HLA-DRA", "TYMP", "HLA-DPA1", "HLA-DRB1", "CST3",
"HLA-DQB1", "HLA-DRB5", "LST1", "CCL5", "LCK", "MS4A6A", "CD3D", "CD7",
"CD3E", "CTSW", "GZMM", "GZMA", "IL32"
),
group = sample(LETTERS[1:2], 20, replace = TRUE)
)
VolcanoPlot(data, x = "avg_log2FC", y = "p_val_adj", y_cutoff_name = "-log10(0.05)")
VolcanoPlot(data,
x = "avg_log2FC", y = "p_val_adj",
label_by = "gene", y_cutoff_name = "-log10(0.05)"
)
VolcanoPlot(data,
x = "avg_log2FC", y = "p_val_adj", y_cutoff_name = "none",
flip_negatives = TRUE, label_by = "gene"
)
VolcanoPlot(data,
x = "avg_log2FC", y = "p_val_adj", y_cutoff_name = "none",
flip_negatives = TRUE, facet_by = "group", label_by = "gene"
)
VolcanoPlot(data,
x = "avg_log2FC", y = "p_val_adj", y_cutoff_name = "none",
flip_negatives = TRUE, split_by = "group", label_by = "gene"
)
# Create sample data with words
data <- data.frame(
word = rep(c(
"apple", "banana", "cherry", "date", "elderberry",
"fig", "grape", "kiwi", "lemon", "mango"
), each = 5),
count = sample(1:50, 50, replace = TRUE),
score = rnorm(50, mean = 5, sd = 2),
group = rep(c("A", "B"), 25)
)
# Basic word cloud from words
WordCloudPlot(data, word_by = "word", count_by = "count", score_by = "score")
# Word cloud with custom palette
WordCloudPlot(data,
word_by = "word", count_by = "count", score_by = "score",
palette = "RdYlBu", palreverse = TRUE
)
# Word cloud with split by group
WordCloudPlot(data,
word_by = "word", count_by = "count", score_by = "score",
split_by = "group", combine = TRUE
)
# Create sample data with sentences
sentence_data <- data.frame(
text = c(
"Data science is an interdisciplinary field",
"Machine learning uses statistical techniques",
"Artificial intelligence is transforming industries",
"Deep learning is a subset of machine learning"
),
score = c(1, 2, 3, 4)
)
# Word cloud from sentences (auto-splitting)
WordCloudPlot(sentence_data,
sentence_by = "text",
score_by = "score",
top_words = 20
)
