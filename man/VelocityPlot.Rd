% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/velocityplot.R
\name{VelocityPlot}
\alias{VelocityPlot}
\title{Cell Velocity Plot}
\usage{
VelocityPlot(
  embedding,
  v_embedding,
  plot_type = c("raw", "grid", "stream"),
  group_by = NULL,
  group_name = "Group",
  group_palette = "Paired",
  group_palcolor = NULL,
  n_neighbors = NULL,
  density = 1,
  smooth = 0.5,
  scale = 1,
  min_mass = 1,
  cutoff_perc = 5,
  arrow_angle = 20,
  arrow_color = "black",
  arrow_alpha = 1,
  streamline_l = 5,
  streamline_minl = 1,
  streamline_res = 1,
  streamline_n = 15,
  streamline_width = c(0, 0.8),
  streamline_alpha = 1,
  streamline_color = NULL,
  streamline_palette = "RdYlBu",
  streamline_palcolor = NULL,
  streamline_bg_color = "white",
  streamline_bg_stroke = 0.5,
  aspect.ratio = 1,
  title = "Cell velocity",
  subtitle = NULL,
  xlab = NULL,
  ylab = NULL,
  legend.position = "right",
  legend.direction = "vertical",
  theme = "theme_ggforge",
  theme_args = list(),
  return_layer = FALSE,
  seed = 8525
)
}
\arguments{
\item{embedding}{Matrix or data.frame of dimension n_obs x n_dim with cell embedding coordinates}

\item{v_embedding}{Matrix or data.frame of dimension n_obs x n_dim with velocity vectors}

\item{plot_type}{Type of plot: "raw" (cell-level arrows), "grid" (smoothed grid arrows), or "stream" (streamlines)}

\item{group_by}{Optional grouping variable for coloring arrows (only for plot_type = "raw")}

\item{group_name}{Name for the grouping legend}

\item{group_palette}{Palette for group colors}

\item{group_palcolor}{Custom colors for groups (overrides group_palette)}

\item{n_neighbors}{Number of nearest neighbors for grid computation}

\item{density}{Density of grid points (or sampling density for raw mode between 0-1)}

\item{smooth}{Smoothing factor for velocity vectors}

\item{scale}{Scaling factor for velocity vectors}

\item{min_mass}{Minimum mass for grid points}

\item{cutoff_perc}{Percentile cutoff for low-density grid points}

\item{arrow_angle}{Angle of arrowheads in degrees}

\item{arrow_color}{Color of arrow heads}

\item{arrow_alpha}{Transparency of arrows (raw and grid modes)}

\item{streamline_l}{Length of streamlines}

\item{streamline_minl}{Minimum length of streamlines}

\item{streamline_res}{Resolution of streamlines}

\item{streamline_n}{Number of streamlines}

\item{streamline_width}{Width range for streamlines}

\item{streamline_alpha}{Transparency of streamlines}

\item{streamline_color}{Fixed color for streamlines (NULL for gradient)}

\item{streamline_palette}{Palette for streamline gradient}

\item{streamline_palcolor}{Custom colors for streamline gradient}

\item{streamline_bg_color}{Background color for streamlines}

\item{streamline_bg_stroke}{Background stroke width}

\item{aspect.ratio}{Aspect ratio of plot}

\item{title}{Plot title}

\item{subtitle}{Plot subtitle}

\item{xlab}{X-axis label}

\item{ylab}{Y-axis label}

\item{legend.position}{Legend position}

\item{legend.direction}{Legend direction}

\item{theme}{Theme name or function}

\item{theme_args}{List of arguments passed to theme function}

\item{return_layer}{Return ggplot layer instead of complete plot}

\item{seed}{Random seed}
}
\value{
A ggplot object or ggplot layer if return_layer = TRUE
}
\description{
Visualize RNA velocity vectors on cell embeddings using arrows or streamlines.
Supports three visualization modes: raw (cell-level arrows), grid (smoothed arrows),
and stream (continuous streamlines).
}
\examples{
\donttest{
# Load example data
data(dim_example)

# Basic raw velocity plot
VelocityPlot(
  embedding = dim_example[, 1:2],
  v_embedding = dim_example[, 3:4]
)

# Velocity plot with grouping
VelocityPlot(
  embedding = dim_example[, 1:2],
  v_embedding = dim_example[, 3:4],
  group_by = dim_example$clusters,
  group_palette = "Set2"
)

# Grid-based velocity plot (smoothed arrows)
VelocityPlot(
  embedding = dim_example[, 1:2],
  v_embedding = dim_example[, 3:4],
  plot_type = "grid",
  density = 2
)

# Streamline velocity plot
VelocityPlot(
  embedding = dim_example[, 1:2],
  v_embedding = dim_example[, 3:4],
  plot_type = "stream",
  streamline_n = 20
)
}
}
