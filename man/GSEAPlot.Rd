% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gsea.R
\name{GSEAPlot}
\alias{GSEAPlot}
\title{GSEA Plot}
\usage{
GSEAPlot(
  data,
  in_form = c("auto", "dose", "fgsea"),
  gene_ranks = "@gene_ranks",
  gene_sets = "@gene_sets",
  gs = NULL,
  sample_coregenes = FALSE,
  line_width = 1.5,
  line_alpha = 1,
  line_color = "#6BB82D",
  n_coregenes = 10,
  genes_label = NULL,
  label_fg = "black",
  label_bg = "white",
  label_bg_r = 0.1,
  label_size = 4,
  title = NULL,
  subtitle = NULL,
  xlab = NULL,
  ylab = NULL,
  combine = TRUE,
  nrow = NULL,
  ncol = NULL,
  byrow = TRUE,
  seed = 8525,
  axes = NULL,
  axis_titles = axes,
  guides = NULL,
  design = NULL,
  theme = "theme_ggforge",
  ...
)
}
\arguments{
\item{data}{A data frame containing the data to plot}

\item{in_form}{The format of the input data
\itemize{
\item \code{fgsea}: The input data is from the \code{fgsea} package.
\item \code{dose}: The input data is from the \code{DOSE} package.
\item \code{auto}: Automatically detect the format of the input data.
When "leadingEdge" is in the input data, it will be treated as "fgsea"; otherwise,
if "core_enrichment" is in the input data, it will be treated as "dose".
}}

\item{gene_ranks}{A numeric vector of gene ranks with genes as names
The gene ranks are used to plot the gene sets.
If \code{gene_ranks} is a character vector starting with \code{@}, the gene ranks will be taken from the attribute of \code{data}.}

\item{gene_sets}{A list of gene sets, typically from a record of a GMT file
The names of the list should match the \code{ID} column of \code{data}.
If \code{gene_sets} is a character vector starting with \code{@}, the gene sets will be taken from the attribute of \code{data}.
The GSEA plots will be plotted for each gene set. So, the number of plots will be the number of gene sets.
If you only want to plot a subset of gene sets, you can subset the \code{gene_sets} before passing it to this function.}

\item{gs}{The names of the gene sets to plot
If \code{NULL}, all gene sets in \code{gene_sets} will be plotted.}

\item{sample_coregenes}{A logical value to sample the core genes from the core_enrichment; if \code{FALSE}, the first \code{n_coregenes} will be used}

\item{line_width}{The width of the line in the running score plot}

\item{line_alpha}{The alpha of the line in the running score plot}

\item{line_color}{The color of the line in the running score plot}

\item{n_coregenes}{The number of core genes to label}

\item{genes_label}{The genes to label. If set, \code{n_coregenes} will be ignored}

\item{label_fg}{The color of the label text}

\item{label_bg}{The background color of the label}

\item{label_bg_r}{The radius of the background color of the label}

\item{label_size}{The size of the label text}

\item{title}{Plot title}

\item{subtitle}{Plot subtitle}

\item{xlab}{X-axis label}

\item{ylab}{Y-axis label}

\item{combine}{Whether to combine split plots into one}

\item{nrow}{Number of rows when combining plots}

\item{ncol}{Number of columns when combining plots}

\item{byrow}{Fill combined plots by row}

\item{seed}{Random seed for reproducibility}

\item{axes}{How to handle axes in combined plots ("keep", "collect", "collect_x", "collect_y")}

\item{axis_titles}{How to handle axis titles in combined plots}

\item{guides}{How to handle guides in combined plots ("collect", "keep", "auto")}

\item{design}{Custom layout design for combined plots}

\item{theme}{Theme name (string) or theme function}
}
\value{
A ggplot object (if single plot) or combined plot object
}
\description{
Creates detailed GSEA plots for one or more gene sets, showing the running enrichment score,
gene positions, and ranked list metric for each set.
}
\examples{
\donttest{
data(gsea_example)

# Plot single gene set
GSEAPlot(gsea_example, gene_sets = attr(gsea_example, "gene_sets")[1])

# Plot multiple gene sets
GSEAPlot(gsea_example, gene_sets = attr(gsea_example, "gene_sets")[1:4])

# Label core genes
GSEAPlot(
  gsea_example,
  gene_sets = attr(gsea_example, "gene_sets")[1],
  n_coregenes = 5
)

# Customize line appearance
GSEAPlot(
  gsea_example,
  gene_sets = attr(gsea_example, "gene_sets")[1],
  line_width = 2,
  line_color = "#FF6B6B"
)

# Return separate plots instead of combined
plots <- GSEAPlot(
  gsea_example,
  gene_sets = attr(gsea_example, "gene_sets")[1:3],
  combine = FALSE
)
}
}
