% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gsea.R
\name{GSEASummaryPlot}
\alias{GSEASummaryPlot}
\title{GSEA Summary Plot}
\usage{
GSEASummaryPlot(
  data,
  in_form = c("auto", "dose", "fgsea"),
  gene_ranks = "@gene_ranks",
  gene_sets = "@gene_sets",
  top_term = 10,
  metric = "p.adjust",
  cutoff = 0.05,
  character_width = 50,
  line_plot_size = 0.25,
  metric_name = metric,
  nonsig_name = "Insignificant",
  linewidth = 0.2,
  line_by = c("prerank", "running_score"),
  title = NULL,
  subtitle = NULL,
  xlab = NULL,
  ylab = NULL,
  alpha = 0.6,
  aspect.ratio = 1,
  legend.position = "right",
  legend.direction = "vertical",
  theme = "theme_ggforge",
  theme_args = list(),
  palette = "Spectral",
  palcolor = NULL,
  seed = 8525,
  ...
)
}
\arguments{
\item{data}{A data frame of GSEA results
For example, from \code{DOSE::gseDO()} or \code{fgsea::fgsea()}.
Required columns are \code{ID}, \code{Description}, \code{NES}, \code{p.adjust}, \code{pvalue}.
The \code{ID} column is used to match the gene sets.}

\item{in_form}{The format of the input data
\itemize{
\item \code{fgsea}: The input data is from the \code{fgsea} package.
\item \code{dose}: The input data is from the \code{DOSE} package.
\item \code{auto}: Automatically detect the format of the input data.
When "leadingEdge" is in the input data, it will be treated as "fgsea"; otherwise,
if "core_enrichment" is in the input data, it will be treated as "dose".
}}

\item{gene_ranks}{A numeric vector of gene ranks with genes as names
The gene ranks are used to plot the gene sets.
If \code{gene_ranks} is a character vector starting with \code{@}, the gene ranks will be taken from the attribute of \code{data}.}

\item{gene_sets}{A list of gene sets, typically from a record of a GMT file
The names of the list should match the \code{ID} column of \code{data}.
If \code{gene_sets} is a character vector starting with \code{@}, the gene sets will be taken from the attribute of \code{data}.}

\item{top_term}{An integer to select the top terms}

\item{metric}{The metric to use for the significance of the terms
Typically the column name of p values or adjusted p values.
It is also used to select the top terms.}

\item{cutoff}{The cutoff for the significance of the terms
The terms will not be filtered with this cutoff; they are only filtered by the \code{top_term} ranked by the \code{metric}.
The cutoff here is used to show the significance of the terms on the plot.
For the terms that are not significant, the color will be grey.}

\item{character_width}{The width of the characters in the y-axis}

\item{line_plot_size}{The size of the line plots}

\item{metric_name}{The name of the metric to show in the color bar}

\item{nonsig_name}{The name of the legend for the nonsignificant terms}

\item{linewidth}{The width of the lines in the line plots}

\item{line_by}{The method to calculate the line plots.
\itemize{
\item \code{prerank}: Use the gene ranks as heights to plot the line plots.
\item \code{running_score}: Use the running score to plot the line plots.
}}

\item{title}{Plot title}

\item{subtitle}{Plot subtitle}

\item{xlab}{X-axis label}

\item{ylab}{Y-axis label}

\item{alpha}{Transparency level (0-1)}

\item{aspect.ratio}{Aspect ratio of plot panel}

\item{legend.position}{Legend position: "none", "left", "right", "bottom", "top"}

\item{legend.direction}{Legend direction: "horizontal" or "vertical"}

\item{theme}{Theme name (string) or theme function}

\item{theme_args}{List of arguments passed to theme function}

\item{palette}{Color palette name}

\item{palcolor}{Custom colors for palette}

\item{seed}{Random seed for reproducibility}
}
\value{
A ggplot object with height and width attributes
}
\description{
Creates a summary visualization of GSEA (Gene Set Enrichment Analysis) results,
showing normalized enrichment scores (NES) with integrated line plots for each term.
}
\examples{
\donttest{
data(gsea_example)

# Basic usage
GSEASummaryPlot(gsea_example)

# Use running score instead of prerank
GSEASummaryPlot(gsea_example, line_by = "running_score")

# Adjust significance cutoff
GSEASummaryPlot(gsea_example, cutoff = 0.01)

# Show more terms
GSEASummaryPlot(gsea_example, top_term = 15)

# Customize color palette
GSEASummaryPlot(gsea_example, palette = "RdYlBu")

# Adjust character width for long pathway names
GSEASummaryPlot(gsea_example, character_width = 70)
}
}
